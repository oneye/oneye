var TemplateDialog;tinyMCEPopup.requireLangPack(),TemplateDialog={preInit:function(){var e=tinyMCEPopup.getParam("template_external_list_url");e!=null&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(e)+'"></sc'+"ript>")},init:function(){var e=tinyMCEPopup.editor,t,n,r,i;t=e.getParam("template_templates",!1),n=document.getElementById("tpath");if(!t&&typeof tinyMCETemplateList!="undefined")for(r=0,t=[];r<tinyMCETemplateList.length;r++)t.push({title:tinyMCETemplateList[r][0],src:tinyMCETemplateList[r][1],description:tinyMCETemplateList[r][2]});for(r=0;r<t.length;r++)n.options[n.options.length]=new Option(t[r].title,tinyMCEPopup.editor.documentBaseURI.toAbsolute(t[r].src));this.resize(),this.tsrc=t},resize:function(){var e,t,n;self.innerWidth?(e=self.innerWidth-50,t=self.innerHeight-170):(e=document.body.clientWidth-50,t=document.body.clientHeight-160),n=document.getElementById("templatesrc"),n&&(n.style.height=Math.abs(t)+"px",n.style.width=Math.abs(e-5)+"px")},loadCSSFiles:function(e){var t=tinyMCEPopup.editor;tinymce.each(t.getParam("content_css","").split(","),function(n){e.write('<link href="'+t.documentBaseURI.toAbsolute(n)+'" rel="stylesheet" type="text/css" />')})},selectTemplate:function(e,t){var n=window.frames.templatesrc.document,r,i=this.tsrc;if(!e)return;n.body.innerHTML=this.templateHTML=this.getFileContents(e);for(r=0;r<i.length;r++)i[r].title==t&&(document.getElementById("tmpldesc").innerHTML=i[r].description||"")},insert:function(){tinyMCEPopup.execCommand("mceInsertTemplate",!1,{content:this.templateHTML,selection:tinyMCEPopup.editor.selection.getContent()}),tinyMCEPopup.close()},getFileContents:function(e){function i(e){t=0;try{t=new ActiveXObject(e)}catch(e){}return t}var t,n,r="text/plain";return t=window.ActiveXObject?i("Msxml2.XMLHTTP")||i("Microsoft.XMLHTTP"):new XMLHttpRequest,t.overrideMimeType&&t.overrideMimeType(r),t.open("GET",e,!1),t.send(null),t.responseText}},TemplateDialog.preInit(),tinyMCEPopup.onInit.add(TemplateDialog.init,TemplateDialog);